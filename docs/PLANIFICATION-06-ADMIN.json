{
  "phase": "06",
  "nom": "FEATURE ADMIN",
  "description": "Dashboard admin avec auth JWT, gestion contacts, CRUD articles avec éditeur",
  "objectif": "Interface admin complète pour gérer contacts et publier articles blog",
  
  "structure_feature": {
    "path": "src/features/admin/",
    "organisation": [
      "components/ → admin (container), contacts/, articles/",
      "services/ → admin.service.ts, article-admin.service.ts",
      "routes/ → admin.routes.ts"
    ]
  },
  
  "workflow": {
    "regles_absolues": [
      "1 FICHIER = 1 MESSAGE = 1 ARTEFACT",
      "Code COMPLET (jamais '...')",
      "STOP après chaque → ATTENDRE '✓ OK'",
      "Ordre strict",
      "TypeScript strict (aucun 'any')"
    ]
  },
  
  "fichiers": [
    {
      "ordre": 1,
      "nom": "admin.interface.ts",
      "path": "src/shared/models/admin.interface.ts",
      "type": "Interface",
      "description": "Interfaces admin",
      "structure": {
        "LoginCredentials": {
          "email": "string",
          "password": "string"
        },
        "AuthResponse": {
          "token": "string",
          "user": "{ email: string, role: string }"
        },
        "ContactStatus": "'nouveau' | 'lu' | 'traité'"
      },
      "instructions": [
        "Interfaces login",
        "AuthResponse avec token",
        "ContactStatus enum"
      ]
    },
    
    {
      "ordre": 2,
      "nom": "auth.guard.ts",
      "path": "src/core/guards/auth.guard.ts",
      "type": "Guard",
      "description": "Guard protection routes admin",
      "instructions": [
        "CanActivateFn type",
        "Inject AuthService",
        "Check isAuthenticated()",
        "Redirect /admin/login si false",
        "Return true si authenticated"
      ]
    },
    
    {
      "ordre": 3,
      "nom": "auth.service.ts",
      "path": "src/core/services/auth.service.ts",
      "type": "Service",
      "description": "Service auth JWT",
      "methodes": [
        "login(credentials): Observable<AuthResponse>",
        "logout(): void",
        "isAuthenticated(): boolean",
        "getToken(): string | null",
        "saveToken(token): void"
      ],
      "instructions": [
        "Injectable({ providedIn: 'root' })",
        "POST /api/auth/login",
        "Store token localStorage",
        "Signal isAuthenticated",
        "Clear token on logout"
      ]
    },
    
    {
      "ordre": 4,
      "nom": "auth.interceptor.ts",
      "path": "src/core/interceptors/auth.interceptor.ts",
      "type": "Interceptor",
      "description": "Interceptor ajout token headers",
      "instructions": [
        "HttpInterceptorFn type",
        "Inject AuthService",
        "Get token",
        "Clone request + add Authorization header",
        "Return next.handle(req)"
      ]
    },
    
    {
      "ordre": 5,
      "nom": "admin.routes.ts",
      "path": "src/features/admin/routes/admin.routes.ts",
      "type": "Routes",
      "description": "Routes admin avec guard",
      "routes": [
        "{ path: 'login', component: AdminLogin }",
        "{ path: '', component: Admin, canActivate: [authGuard], children: [",
        "  { path: '', redirectTo: 'contacts', pathMatch: 'full' },",
        "  { path: 'contacts', component: ContactsList },",
        "  { path: 'articles', component: ArticlesList },",
        "  { path: 'articles/new', component: ArticleEditor },",
        "  { path: 'articles/:id/edit', component: ArticleEditor }",
        "]}"
      ],
      "instructions": [
        "Route login publique",
        "Routes admin protégées par authGuard",
        "Child routes pour contacts/articles",
        "Lazy loading"
      ]
    },
    
    {
      "ordre": 6,
      "nom": "admin-login.ts",
      "path": "src/features/admin/components/admin-login/admin-login.ts",
      "type": "Component",
      "description": "Page login admin",
      "structure": {
        "selector": "app-admin-login",
        "standalone": true,
        "imports": ["ReactiveFormsModule", "Router"],
        "templateUrl": "./admin-login.html",
        "styleUrl": "./admin-login.scss"
      },
      "logique": [
        "FormGroup (email, password)",
        "Signal isLoading, error",
        "onSubmit() → authService.login()",
        "Success → navigate /admin",
        "Error → display message"
      ],
      "instructions": [
        "Form validation",
        "Disable submit si loading",
        "Store token on success",
        "Navigate admin dashboard"
      ]
    },
    
    {
      "ordre": 7,
      "nom": "admin-login.html",
      "path": "src/features/admin/components/admin-login/admin-login.html",
      "type": "Template",
      "description": "Template login",
      "structure": [
        "<div class=\"login-container\">",
        "  <h1>Connexion Admin</h1>",
        "  <form [formGroup]=\"loginForm\" (ngSubmit)=\"onSubmit()\">",
        "    <div class=\"form-field\">",
        "      <label for=\"email\">Email</label>",
        "      <input id=\"email\" formControlName=\"email\" type=\"email\" />",
        "    </div>",
        "    <div class=\"form-field\">",
        "      <label for=\"password\">Mot de passe</label>",
        "      <input id=\"password\" formControlName=\"password\" type=\"password\" />",
        "    </div>",
        "    @if (error()) {",
        "      <div class=\"error-message\">{{ error() }}</div>",
        "    }",
        "    <button type=\"submit\" [disabled]=\"loginForm.invalid || isLoading()\">",
        "      {{ isLoading() ? 'Connexion...' : 'Se connecter' }}",
        "    </button>",
        "  </form>",
        "</div>"
      ],
      "instructions": [
        "Centré verticalement",
        "Form simple email + password",
        "Error message si échec"
      ]
    },
    
    {
      "ordre": 8,
      "nom": "admin-login.scss",
      "path": "src/features/admin/components/admin-login/admin-login.scss",
      "type": "Styles",
      "description": "Styles login page",
      "instructions": [
        "@use '@shared/styles' as *",
        "Centré viewport",
        "Container max-width 400px",
        "Design Modern Editorial"
      ]
    },
    
    {
      "ordre": 9,
      "nom": "admin.ts",
      "path": "src/features/admin/components/admin.ts",
      "type": "Component",
      "description": "Container admin dashboard",
      "structure": {
        "selector": "app-admin",
        "standalone": true,
        "imports": ["RouterOutlet", "RouterLink"],
        "templateUrl": "./admin.html",
        "styleUrl": "./admin.scss"
      },
      "logique": [
        "Inject AuthService, Router",
        "Signal currentUser",
        "logout() method → authService.logout() + navigate /admin/login"
      ],
      "instructions": [
        "Layout: sidebar + content",
        "Sidebar: liens Contacts, Articles",
        "Header: user email + logout",
        "RouterOutlet pour child routes"
      ]
    },
    
    {
      "ordre": 10,
      "nom": "admin.html",
      "path": "src/features/admin/components/admin.html",
      "type": "Template",
      "description": "Template dashboard",
      "structure": [
        "<div class=\"admin-layout\">",
        "  <aside class=\"admin-sidebar\">",
        "    <h2>Admin</h2>",
        "    <nav>",
        "      <a routerLink=\"/admin/contacts\" routerLinkActive=\"active\">Contacts</a>",
        "      <a routerLink=\"/admin/articles\" routerLinkActive=\"active\">Articles</a>",
        "    </nav>",
        "    <button class=\"logout-button\" (click)=\"logout()\">Déconnexion</button>",
        "  </aside>",
        "  <main class=\"admin-content\">",
        "    <router-outlet />",
        "  </main>",
        "</div>"
      ],
      "instructions": [
        "Layout grid sidebar + main",
        "Nav links avec routerLinkActive",
        "Logout button"
      ]
    },
    
    {
      "ordre": 11,
      "nom": "admin.scss",
      "path": "src/features/admin/components/admin.scss",
      "type": "Styles",
      "description": "Styles layout admin",
      "instructions": [
        "@use '@shared/styles' as *",
        "Grid: sidebar 250px + main 1fr",
        "Sidebar: background $color-primary, text white",
        "Active link: accent color"
      ]
    },
    
    {
      "ordre": 12,
      "nom": "admin.service.ts",
      "path": "src/features/admin/services/admin.service.ts",
      "type": "Service",
      "description": "Service API admin contacts",
      "methodes": [
        "getContacts(): Observable<Contact[]>",
        "updateContactStatus(id, status): Observable<void>"
      ],
      "instructions": [
        "Injectable({ providedIn: 'root' })",
        "GET /api/contacts",
        "PATCH /api/contacts/:id/status",
        "Auth token auto ajouté par interceptor"
      ]
    },
    
    {
      "ordre": 13,
      "nom": "contacts-list.ts",
      "path": "src/features/admin/components/contacts/contacts-list/contacts-list.ts",
      "type": "Component",
      "description": "Liste demandes contact",
      "structure": {
        "selector": "app-contacts-list",
        "standalone": true,
        "imports": ["NgFor", "DatePipe"],
        "templateUrl": "./contacts-list.html",
        "styleUrl": "./contacts-list.scss"
      },
      "logique": [
        "Inject AdminService",
        "Signal contacts",
        "ngOnInit: loadContacts()",
        "updateStatus(id, status) → service.updateContactStatus()"
      ],
      "instructions": [
        "Table contacts",
        "Colonnes: date, nom, email, sujet, message, statut",
        "Dropdown statut (nouveau/lu/traité)",
        "Filtre par statut optionnel"
      ]
    },
    
    {
      "ordre": 14,
      "nom": "contacts-list.html",
      "path": "src/features/admin/components/contacts/contacts-list/contacts-list.html",
      "type": "Template",
      "description": "Template liste contacts",
      "structure": [
        "<div class=\"contacts-list\">",
        "  <h1>Demandes de Contact</h1>",
        "  <table>",
        "    <thead>",
        "      <tr>",
        "        <th>Date</th>",
        "        <th>Nom</th>",
        "        <th>Email</th>",
        "        <th>Sujet</th>",
        "        <th>Message</th>",
        "        <th>Statut</th>",
        "      </tr>",
        "    </thead>",
        "    <tbody>",
        "      @for (contact of contacts(); track contact.id) {",
        "        <tr>",
        "          <td>{{ contact.createdAt | date }}</td>",
        "          <td>{{ contact.firstName }} {{ contact.lastName }}</td>",
        "          <td>{{ contact.email }}</td>",
        "          <td>{{ contact.subject }}</td>",
        "          <td class=\"message-preview\">{{ contact.message }}</td>",
        "          <td>",
        "            <select [value]=\"contact.status\" (change)=\"updateStatus(contact.id, $event.target.value)\">",
        "              <option value=\"nouveau\">Nouveau</option>",
        "              <option value=\"lu\">Lu</option>",
        "              <option value=\"traité\">Traité</option>",
        "            </select>",
        "          </td>",
        "        </tr>",
        "      }",
        "    </tbody>",
        "  </table>",
        "</div>"
      ],
      "instructions": [
        "Table responsive",
        "Message truncate avec ellipsis",
        "Dropdown statut inline"
      ]
    },
    
    {
      "ordre": 15,
      "nom": "contacts-list.scss",
      "path": "src/features/admin/components/contacts/contacts-list/contacts-list.scss",
      "type": "Styles",
      "description": "Styles table contacts",
      "instructions": [
        "@use '@shared/styles' as *",
        "Table full-width",
        "Borders subtle",
        "Hover row: background light",
        "Message preview: max-width, ellipsis"
      ]
    },
    
    {
      "ordre": 16,
      "nom": "article-admin.service.ts",
      "path": "src/features/admin/services/article-admin.service.ts",
      "type": "Service",
      "description": "Service API admin articles",
      "methodes": [
        "createArticle(data): Observable<Article>",
        "updateArticle(id, data): Observable<Article>",
        "deleteArticle(id): Observable<void>",
        "publishArticle(id): Observable<Article>"
      ],
      "instructions": [
        "Injectable({ providedIn: 'root' })",
        "POST /api/articles",
        "PUT /api/articles/:id",
        "DELETE /api/articles/:id",
        "PATCH /api/articles/:id/publish"
      ]
    },
    
    {
      "ordre": 17,
      "nom": "articles-list.ts",
      "path": "src/features/admin/components/articles/articles-list/articles-list.ts",
      "type": "Component",
      "description": "Liste articles admin (draft + published)",
      "structure": {
        "selector": "app-articles-list",
        "standalone": true,
        "imports": ["NgFor", "RouterLink", "DatePipe"],
        "templateUrl": "./articles-list.html",
        "styleUrl": "./articles-list.scss"
      },
      "logique": [
        "Inject ArticleStateService, ArticleAdminService",
        "Signal articles (tous statuts)",
        "deleteArticle(id)",
        "publishArticle(id)"
      ],
      "instructions": [
        "Table articles",
        "Actions: Edit, Delete, Publish",
        "Bouton + Nouvel article"
      ]
    },
    
    {
      "ordre": 18,
      "nom": "articles-list.html",
      "path": "src/features/admin/components/articles/articles-list/articles-list.html",
      "type": "Template",
      "description": "Template liste articles admin",
      "structure": [
        "<div class=\"articles-list\">",
        "  <header>",
        "    <h1>Articles</h1>",
        "    <a routerLink=\"/admin/articles/new\" class=\"btn-primary\">+ Nouvel article</a>",
        "  </header>",
        "  <table>",
        "    <thead>",
        "      <tr>",
        "        <th>Titre</th>",
        "        <th>Catégorie</th>",
        "        <th>Statut</th>",
        "        <th>Date</th>",
        "        <th>Actions</th>",
        "      </tr>",
        "    </thead>",
        "    <tbody>",
        "      @for (article of articles(); track article.id) {",
        "        <tr>",
        "          <td>{{ article.title }}</td>",
        "          <td>{{ article.category }}</td>",
        "          <td>",
        "            <span class=\"badge\" [class]=\"article.status\">{{ article.status }}</span>",
        "          </td>",
        "          <td>{{ article.updatedAt | date }}</td>",
        "          <td class=\"actions\">",
        "            <a [routerLink]=\"'/admin/articles/' + article.id + '/edit'\">Modifier</a>",
        "            @if (article.status === 'draft') {",
        "              <button (click)=\"publishArticle(article.id)\">Publier</button>",
        "            }",
        "            <button (click)=\"deleteArticle(article.id)\" class=\"danger\">Supprimer</button>",
        "          </td>",
        "        </tr>",
        "      }",
        "    </tbody>",
        "  </table>",
        "</div>"
      ],
      "instructions": [
        "Header avec bouton Nouvel article",
        "Badge statut coloré",
        "Actions: Edit, Publish (si draft), Delete"
      ]
    },
    
    {
      "ordre": 19,
      "nom": "articles-list.scss",
      "path": "src/features/admin/components/articles/articles-list/articles-list.scss",
      "type": "Styles",
      "description": "Styles liste articles",
      "instructions": [
        "@use '@shared/styles' as *",
        "Header flex justify-between",
        "Badge: draft orange, published green",
        "Actions buttons inline"
      ]
    },
    
    {
      "ordre": 20,
      "nom": "article-editor.ts",
      "path": "src/features/admin/components/articles/article-editor/article-editor.ts",
      "type": "Component",
      "description": "Éditeur article (create/update)",
      "structure": {
        "selector": "app-article-editor",
        "standalone": true,
        "imports": ["ReactiveFormsModule", "ActivatedRoute"],
        "templateUrl": "./article-editor.html",
        "styleUrl": "./article-editor.scss"
      },
      "logique": [
        "Inject ArticleAdminService, ActivatedRoute",
        "FormGroup complet (title, excerpt, content, category, relatedService, tags, coverImage)",
        "Mode: create ou edit (selon route param id)",
        "ngOnInit: if id → load article + patchValue",
        "onSubmit() → create ou update",
        "Auto-save draft optionnel"
      ],
      "instructions": [
        "Form validation",
        "Textarea content (Markdown ou WYSIWYG simple)",
        "Dropdown category, relatedService",
        "Tags input (comma-separated)",
        "Save draft button + Publish button",
        "Preview optionnel"
      ]
    },
    
    {
      "ordre": 21,
      "nom": "article-editor.html",
      "path": "src/features/admin/components/articles/article-editor/article-editor.html",
      "type": "Template",
      "description": "Template éditeur",
      "structure": [
        "<div class=\"article-editor\">",
        "  <h1>{{ isEditMode() ? 'Modifier' : 'Nouvel' }} Article</h1>",
        "  <form [formGroup]=\"articleForm\" (ngSubmit)=\"onSubmit()\">",
        "    <div class=\"form-field\">",
        "      <label for=\"title\">Titre *</label>",
        "      <input id=\"title\" formControlName=\"title\" type=\"text\" />",
        "    </div>",
        "    ",
        "    <div class=\"form-field\">",
        "      <label for=\"excerpt\">Résumé *</label>",
        "      <textarea id=\"excerpt\" formControlName=\"excerpt\" rows=\"3\"></textarea>",
        "    </div>",
        "    ",
        "    <div class=\"form-field\">",
        "      <label for=\"content\">Contenu *</label>",
        "      <textarea id=\"content\" formControlName=\"content\" rows=\"20\"></textarea>",
        "    </div>",
        "    ",
        "    <div class=\"form-row\">",
        "      <div class=\"form-field\">",
        "        <label for=\"category\">Catégorie *</label>",
        "        <select id=\"category\" formControlName=\"category\">",
        "          <option value=\"copywriting\">Copywriting</option>",
        "          <option value=\"seo\">SEO</option>",
        "          <option value=\"strategy\">Stratégie</option>",
        "          <option value=\"web-design\">Web Design</option>",
        "          <option value=\"case-study\">Étude de Cas</option>",
        "        </select>",
        "      </div>",
        "      ",
        "      <div class=\"form-field\">",
        "        <label for=\"relatedService\">Service Associé *</label>",
        "        <select id=\"relatedService\" formControlName=\"relatedService\">",
        "          <option value=\"copywriting\">Copywriting</option>",
        "          <option value=\"content-strategy\">Stratégie de Contenu</option>",
        "          <option value=\"seo-writing\">SEO Rédaction</option>",
        "          <option value=\"web-creation\">Création Sites Web</option>",
        "        </select>",
        "      </div>",
        "    </div>",
        "    ",
        "    <div class=\"form-field\">",
        "      <label for=\"tags\">Tags (séparés par virgules)</label>",
        "      <input id=\"tags\" formControlName=\"tags\" type=\"text\" />",
        "    </div>",
        "    ",
        "    <div class=\"form-field\">",
        "      <label for=\"coverImage\">Image de couverture (URL)</label>",
        "      <input id=\"coverImage\" formControlName=\"coverImage\" type=\"url\" />",
        "    </div>",
        "    ",
        "    <div class=\"form-actions\">",
        "      <button type=\"button\" (click)=\"saveDraft()\" class=\"btn-secondary\">",
        "        Enregistrer brouillon",
        "      </button>",
        "      <button type=\"submit\" class=\"btn-primary\">",
        "        {{ isEditMode() ? 'Mettre à jour' : 'Publier' }}",
        "      </button>",
        "    </div>",
        "  </form>",
        "</div>"
      ],
      "instructions": [
        "Form complet",
        "Textarea content large",
        "Dropdowns category + relatedService",
        "Tags input text",
        "Boutons: Draft + Publish"
      ]
    },
    
    {
      "ordre": 22,
      "nom": "article-editor.scss",
      "path": "src/features/admin/components/articles/article-editor/article-editor.scss",
      "type": "Styles",
      "description": "Styles éditeur",
      "instructions": [
        "@use '@shared/styles' as *",
        "Max-width: 800px",
        "Form-field spacing",
        "Textarea content: font monospace",
        "Actions: flex justify-end"
      ]
    }
  ],
  
  "validation_phase": {
    "criteres": [
      "Tous fichiers créés et validés",
      "/admin/login fonctionne",
      "JWT token stocké après login",
      "Dashboard admin accessible",
      "Liste contacts affichée",
      "Update statut contact OK",
      "Liste articles admin affichée",
      "Créer/modifier article fonctionne",
      "Publier article change statut",
      "Guard protège routes admin",
      "Interceptor ajoute token auto"
    ],
    "commandes_test": [
      "ng serve",
      "http://localhost:4200/admin/login",
      "Login → redirect /admin",
      "Voir contacts, articles",
      "Créer nouvel article → save"
    ]
  },
  
  "notes_importantes": [
    "Auth JWT avec localStorage",
    "Guard authGuard protège routes",
    "Interceptor auth auto header",
    "Admin service pour contacts",
    "ArticleAdminService pour CRUD articles",
    "Éditeur simple (textarea Markdown ou WYSIWYG basique)",
    "Auto-save draft optionnel (nice-to-have)",
    "Publish button change status → published",
    "Design admin sobre (pas besoin ultra-design)",
    "1 fichier = 1 validation obligatoire"
  ]
}
